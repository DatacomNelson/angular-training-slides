<!DOCTYPE HTML>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="search-domain" content="http://rangle.io" />
    <link href="http://localhost:4000/css/bootstrap.css" rel="stylesheet" />
    <link href="http://localhost:4000/css/bootstrap-theme.css" rel="stylesheet" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Template Driven Forms</title>
  </head>
  <body>
    <div class="container shadow">
      <div class="row-fluid">
        <div class="span10 offset1">
          <p><a href="http://rangle.io">Rangle.io</a> Angular Training</a></p>
          <h1>Template Driven Forms</h1>
          <hr />
<!-- .slide: id="template-forms-roadmap" -->

<h2 id="roadmap">Roadmap</h2>

<ol>
  <li>How does Angular support forms?</li>
  <li>How do I create a template driven form?</li>
  <li>How do I handle form data?</li>
  <li>How do I validate form data?</li>
  <li>How do I display error messages?</li>
</ol>

<hr />
<!-- .slide: id="template-forms-overview" -->
<h2 id="overview">Overview</h2>

<ul>
  <li>Template Driven Forms: controls and validation rules defined in the template with directives</li>
  <li>Reactive Forms: controls and validation rules defined in the component class or service
    <ul>
      <li>Explore these in the next section</li>
    </ul>
  </li>
</ul>

<hr />
<!-- .slide: id="template-forms-creating" -->
<h2 id="creating-template-driven-forms">Creating Template Driven Forms</h2>

<ul>
  <li>Import <code class="highlighter-rouge">FormsModule</code> from <code class="highlighter-rouge">@angular/forms</code> into <code class="highlighter-rouge">app.module.ts</code></li>
  <li>Allow us to use all the features of template-driven forms</li>
</ul>

<p><em>src/app/app.module.ts</em></p>
<div class="language-ts highlighter-rouge"><pre class="highlight"><code><span class="c1">// ...existing imports...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">FormsModule</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/forms'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">NgModule</span><span class="p">({</span>
  <span class="c1">// ...as before...</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">BrowserModule</span><span class="p">,</span>
    <span class="nx">HttpModule</span><span class="p">,</span>
    <span class="nx">FormsModule</span>        <span class="c1">// added</span>
  <span class="p">],</span>
  <span class="c1">// ...as before...</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{</span> <span class="p">}</span>
</code></pre>
</div>

<hr />
<!-- .slide: id="template-forms-handing-form-data-1" -->
<h2 id="handling-form-data">Handling Form Data</h2>

<ul>
  <li>Use <code class="highlighter-rouge">ngModel</code> and <code class="highlighter-rouge">ngForm</code> directives to handle form data</li>
  <li><code class="highlighter-rouge">ngForm</code> provides properties to get information from the form like <code class="highlighter-rouge">value</code> and <code class="highlighter-rouge">valid</code></li>
  <li><code class="highlighter-rouge">ngModel</code> provides the same property for individual fields</li>
</ul>

<p><em>src/app/generic-input/generic-input.component.html</em></p>
<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="err">#</span><span class="na">newItemForm=</span><span class="s">"ngForm"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>New Item: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"newItem"</span> <span class="na">ngModel</span><span class="nt">&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
</div>

<!-- example: https://plnkr.co/edit/sdVst5yprdQUgQctQz9p?p=preview -->

<hr />
<!-- .slide: id="template-forms-handling-form-data-2" -->
<h2 id="handling-form-data-1">Handling Form Data</h2>

<ul>
  <li>Every <code class="highlighter-rouge">&lt;form&gt;</code> element is automatically enhanced by the <code class="highlighter-rouge">NgForm</code> directive</li>
  <li><code class="highlighter-rouge">newItemForm</code> is a template variable that holds a reference to the <code class="highlighter-rouge">NgForm</code> directive instance</li>
  <li><code class="highlighter-rouge">ngModel</code> turns a form field into a <code class="highlighter-rouge">FormControl</code> using the element <code class="highlighter-rouge">name</code> property…</li>
  <li>…and registers it with the form</li>
  <li>Every control that registers with the <code class="highlighter-rouge">ngForm</code> automatically appears in the <code class="highlighter-rouge">form.value</code> property</li>
</ul>

<hr />
<!-- .slide: id="template-forms-ngform" -->
<h2 id="ngform">NgForm</h2>

<p><code class="highlighter-rouge">NgForm</code> instances have several useful properties:</p>

<ul>
  <li><code class="highlighter-rouge">newItemForm.value</code>: all form values</li>
  <li><code class="highlighter-rouge">newItemForm.valid</code>: whether the form is valid</li>
  <li><code class="highlighter-rouge">newItemForm.value.newItem</code>: the value of the <code class="highlighter-rouge">newItem</code> field</li>
</ul>

<p><em>src/app/generic-input/generic-input.component.html</em></p>
<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="err">#</span><span class="na">newItemForm=</span><span class="s">"ngForm"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>New Item: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"newItem"</span> <span class="na">ngModel</span><span class="nt">&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
</div>

<hr />
<!-- .slide: id="template-forms-ngmodel-1" -->
<h2 id="ngmodel">NgModel</h2>

<p><code class="highlighter-rouge">NgModel</code> has similiar properties and more related to specific fields:</p>

<ul>
  <li><code class="highlighter-rouge">value</code>: the field’s value</li>
  <li><code class="highlighter-rouge">valid</code>: the field’s validity (Boolean)</li>
  <li><code class="highlighter-rouge">pristine</code>: indicates whether the value has changed from the default (Boolean)</li>
  <li><code class="highlighter-rouge">touched</code>: Indicates whether the field was clicked, tabbed, or tapped (Boolean)</li>
</ul>

<hr />
<!-- .slide: id="template-forms-ngmodel-2" -->
<h2 id="ngmodel-1">NgModel</h2>

<p><em>src/app/generic-input/generic-input.component.html</em></p>
<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="err">#</span><span class="na">newItemForm=</span><span class="s">"ngForm"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>New Item: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"newItem"</span> <span class="na">ngModel</span><span class="nt">&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;p&gt;</span>Form valid: {{newItemForm.valid}}<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;p&gt;</span>Form control value: {{newItemForm.value.newItem}}<span class="nt">&lt;/p&gt;</span>
</code></pre>
</div>

<p><img src="./images/screenshot-showing-form-values.png" alt="Showing Form Values" /></p>

<!-- preview: https://plnkr.co/edit/oVQhf641Nx1qpaBG5jeN?p=preview -->

<hr />
<!-- .slide: id="template-forms-template-variables" -->
<h2 id="template-variables">Template Variables</h2>

<ul>
  <li>Easier to access the control using a template variable</li>
  <li>The template variable <code class="highlighter-rouge">#newItem</code> is an instance of <code class="highlighter-rouge">FormControl</code></li>
</ul>

<p>#####<em>src/app/generic-input/generic-input.component.html</em></p>
<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="err">#</span><span class="na">newItemForm=</span><span class="s">"ngForm"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>New Item: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"newItem"</span> <span class="err">#</span><span class="na">newItem=</span><span class="s">"ngModel"</span> <span class="na">ngModel</span><span class="nt">&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;p&gt;</span>Form valid: <span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;p&gt;</span>Form control value: <span class="nt">&lt;/p&gt;</span>
</code></pre>
</div>

<p><img src="content/images/screenshot-showing-form-values.png" alt="Showing Form Values" /></p>

<!-- preview: https://plnkr.co/edit/oVQhf641Nx1qpaBG5jeN?p=preview -->

<hr />
<!-- .slide: id="template-forms-handling-form-submissions-1" -->
<h2 id="handling-form-submissions">Handling Form Submissions</h2>

<ul>
  <li><code class="highlighter-rouge">ngSubmit</code> event handler automatically added to the <code class="highlighter-rouge">form</code> element
    <ul>
      <li>But we must tell Angular what method to invoke</li>
      <li>Pass the form object so that the class has everything it might want</li>
    </ul>
  </li>
  <li>Need a “submit” button to trigger form submission</li>
</ul>

<p><em>src/app/generic-input/generic-input.component.html</em></p>
<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="err">#</span><span class="na">newItemForm=</span><span class="s">"ngForm"</span> <span class="err">(</span><span class="na">ngSubmit</span><span class="err">)="</span><span class="na">addToDo</span><span class="err">(</span><span class="na">newItemForm</span><span class="err">)"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    New Item: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"newItem"</span> <span class="na">ngModel</span><span class="nt">&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Add<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
</div>

<hr />
<!-- .slide: id="template-forms-handling-form-submissions-2" -->
<h2 id="handling-form-submissions-1">Handling Form Submissions</h2>

<ul>
  <li>Modify <code class="highlighter-rouge">addToDo</code> to take an <code class="highlighter-rouge">NgForm</code> as input</li>
</ul>

<p>#####<em>src/app/generic-input/generic-input.component.html</em></p>
<div class="language-ts highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">NgForm</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/forms'</span><span class="p">;</span>

<span class="k">export</span> <span class="kr">class</span> <span class="nx">GenericInputComponent</span> <span class="k">implements</span> <span class="nx">OnInit</span> <span class="p">{</span>
  <span class="c1">// ...as before...</span>
  <span class="nx">addToDo</span><span class="p">(</span><span class="nx">newItemForm</span><span class="err">:</span> <span class="nx">NgForm</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">newItem</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="nx">newItemForm</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">newItem</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<!-- preview: https://plnkr.co/edit/Xxcf46sO5TWK1EKme1qF?p=preview -->

<hr />
<!-- .slide: id="template-forms-built-in-validators" -->
<h2 id="built-in-validators">Built-In Validators</h2>

<ul>
  <li><code class="highlighter-rouge">required</code>: field cannot be empty
    <ul>
      <li><code class="highlighter-rouge">&lt;input required&gt;</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">pattern</code>: field value must match a regular expression
    <ul>
      <li><code class="highlighter-rouge">&lt;input pattern="[A-Za-z0-9]{0,5}"&gt;</code></li>
      <li>Note: <code class="highlighter-rouge">pattern</code> only supports a subset of JavaScript regular expression syntax</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">minlength</code>: must have at least a certain number of characters
    <ul>
      <li><code class="highlighter-rouge">&lt;input minlength="3"&gt;</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">maxlength</code>: may not have more than a certain number of characters
    <ul>
      <li><code class="highlighter-rouge">&lt;input maxlength="5"&gt;</code></li>
      <li>prevents additional characters from being entered</li>
      <li>others only produce a warning</li>
    </ul>
  </li>
</ul>

<hr />
<!-- .slide: id="template-forms-performing-validation" -->
<h2 id="performing-validation">Performing Validation</h2>

<ul>
  <li>To perform validation, we have to use a template variable for the given field <code class="highlighter-rouge">#field="ngModel"</code></li>
</ul>

<p>#####<em>src/app/generic-input/generic-input.component.html</em></p>
<div class="language-html highlighter-rouge"><pre class="highlight"><code>  ...
    New Item: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"newItem"</span> <span class="err">#</span><span class="na">newItem=</span><span class="s">"ngModel"</span> <span class="na">ngModel</span> <span class="na">required</span><span class="nt">&gt;</span>
  ...
</code></pre>
</div>

<ul>
  <li>As mentioned earlier the template variable <code class="highlighter-rouge">#newItem</code> is an instance of <code class="highlighter-rouge">FormControl</code></li>
  <li>Has <code class="highlighter-rouge">value</code>, <code class="highlighter-rouge">valid</code>, <code class="highlighter-rouge">pristine</code>, and <code class="highlighter-rouge">touched</code> properties described earlier</li>
</ul>

<hr />
<!-- .slide: id="template-forms-displaying-error-messages" -->
<h2 id="displaying-error-messages">Displaying Error Messages</h2>

<ul>
  <li>Use form validation state to control visibility using <code class="highlighter-rouge">hidden</code> property</li>
  <li>Check validator errors by calling <code class="highlighter-rouge">hasError</code> on the <code class="highlighter-rouge">FormControl</code></li>
</ul>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="err">#</span><span class="na">newItemForm=</span><span class="s">"ngForm"</span> <span class="err">(</span><span class="na">ngSubmit</span><span class="err">)="</span><span class="na">registerUser</span><span class="err">(</span><span class="na">newItemForm</span><span class="err">)"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>New Item: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"newItem"</span> <span class="err">#</span><span class="na">newItem=</span><span class="s">"ngModel"</span> <span class="na">ngModel</span> <span class="na">required</span><span class="nt">&gt;&lt;/p&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"errors"</span> <span class="err">[</span><span class="na">hidden</span><span class="err">]="</span><span class="na">newItem</span><span class="err">.</span><span class="na">valid</span><span class="err">"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li</span> <span class="err">[</span><span class="na">hidden</span><span class="err">]="!</span><span class="na">newItem</span><span class="err">.</span><span class="na">hasError</span><span class="err">('</span><span class="na">required</span><span class="err">')"</span><span class="nt">&gt;</span>
      The first name is required
    <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="err">[</span><span class="na">disabled</span><span class="err">]="!</span><span class="na">newItemForm</span><span class="err">.</span><span class="na">valid</span><span class="err">"</span><span class="nt">&gt;</span>Add<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
</div>

<ul>
  <li>But error message shows up before user starts typing…</li>
</ul>

<!-- preview: https://plnkr.co/edit/zgAQW3pQjGqRGhAQvE7j?p=preview -->

<hr />
<!-- .slide: id="template-forms-styling-the-form-1" -->
<h2 id="styling-the-form">Styling the Form</h2>

<ul>
  <li>Along with data binding <code class="highlighter-rouge">ngModel</code> gives us information about the control’s state</li>
  <li>Can notify us if the control was touched or changed
or if the value became invalid</li>
  <li>The following CSS classes are available for this:</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Class if true</th>
      <th>Class if false</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ng-valid</td>
      <td>ng-invalid</td>
      <td>The model is valid</td>
    </tr>
    <tr>
      <td>ng-dirty</td>
      <td>ng-pristine</td>
      <td>The control has been interacted with</td>
    </tr>
    <tr>
      <td>ng-touched</td>
      <td>ng-untouched</td>
      <td>The control has been blurred</td>
    </tr>
  </tbody>
</table>

<hr />
<!-- .slide: id="template-forms-styling-the-form-2" -->
<h2 id="styling-the-form-1">Styling the Form</h2>

<ul>
  <li>Change example to use these styles</li>
</ul>

<p><em>src/app/generic-input/generic-input.component.html</em></p>
<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;form</span> <span class="err">#</span><span class="na">newItemForm=</span><span class="s">"ngForm"</span> <span class="err">(</span><span class="na">ngSubmit</span><span class="err">)="</span><span class="na">registerUser</span><span class="err">(</span><span class="na">newItemForm</span><span class="err">)"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;p&gt;</span>New Item: <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"newItem"</span> <span class="err">#</span><span class="na">newItem=</span><span class="s">"ngModel"</span> <span class="na">ngModel</span> <span class="na">required</span><span class="nt">&gt;&lt;/p&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"errors"</span> <span class="err">[</span><span class="na">hidden</span><span class="err">]="</span><span class="na">newItem</span><span class="err">.</span><span class="na">valid</span> <span class="err">||</span> <span class="na">newItem</span><span class="err">.</span><span class="na">untouched</span><span class="err">"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li</span> <span class="err">[</span><span class="na">hidden</span><span class="err">]="!</span><span class="na">newItem</span><span class="err">.</span><span class="na">hasError</span><span class="err">('</span><span class="na">required</span><span class="err">')"</span><span class="nt">&gt;</span>
      The first name is required
    <span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="err">[</span><span class="na">disabled</span><span class="err">]="!</span><span class="na">newItemForm</span><span class="err">.</span><span class="na">valid</span><span class="err">"</span><span class="nt">&gt;</span>Add<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre>
</div>
<!-- https://plnkr.co/edit/0TR3iu3ANajJdbWixB83?p=preview -->

<hr />
<!-- .slide: id="template-forms-styling-the-form-3" -->
<h2 id="styling-the-form-2">Styling the Form</h2>

<ul>
  <li>Use these classes and properties with CSS and HTML to create user-friendly forms</li>
</ul>

<p><em>src/app/generic-input/generic-input.component.css</em></p>
<div class="language-css highlighter-rouge"><pre class="highlight"><code><span class="nc">.ng-valid</span><span class="o">[</span><span class="nt">required</span><span class="o">],</span> <span class="nc">.ng-valid.required</span>  <span class="p">{</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#DFD</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.ng-invalid.ng-touched</span><span class="nd">:not</span><span class="o">(</span><span class="nt">form</span><span class="o">)</span> <span class="p">{</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#FDD</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<hr />
<!-- .slide: id="template-forms-styling-the-form-4" -->
<h2 id="styling-the-form-3">Styling the Form</h2>

<p><img src="./images/screenshot-form-css.png" alt="Styling the Form" /></p>

<!-- https://plnkr.co/edit/BQdO11mdaRpsrk7OD40e?p=preview -->

          <hr/>
          <a href="http://localhost:4000/">Home</a>
        </div>
      </div>
    </div>
  </body>
</html>
